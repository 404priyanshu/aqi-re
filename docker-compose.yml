version: '3.8'

services:
  aqi-monitor:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: aqi-monitoring-system
    ports:
      - "8000:8000"
    environment:
      - AQICN_API_KEY=${AQICN_API_KEY:-}
      - DEFAULT_CITY=${DEFAULT_CITY:-delhi}
      - DATA_FETCH_INTERVAL=${DATA_FETCH_INTERVAL:-300}
    volumes:
      - aqi_data:/app/data
      - aqi_models:/app/models
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

volumes:
  aqi_data:
    driver: local
  aqi_models:
    driver: local
